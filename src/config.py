from __future__ import annotations
from pathlib import Path

# ============================================================
# Project root
#   config.py is located at: PROJECT_ROOT / src / config.py
# ============================================================
PROJECT_ROOT = Path(__file__).resolve().parents[1]  # type: ignore


# ============================================================
# Data directories (project data backbone)
# ============================================================
DATA_DIR = PROJECT_ROOT / "data"

RAW_DIR = DATA_DIR / "raw"
PROCESSED_DIR = DATA_DIR / "processed"
FEATURE_DIR = DATA_DIR / "features"
PREPROCESSED_DIR = DATA_DIR / "preprocessed"
FORECAST_DIR = DATA_DIR / "forecast"
SPLIT_DIR = DATA_DIR / "split"

# ---- train / validation / test ----
TRAIN_DIR = SPLIT_DIR / "train"

TEST_DIR = SPLIT_DIR / "test"


# ============================================================
# Forecast subdirectories (shared across modeling / API / UI)
# ============================================================
FORECAST_FUTURE_DATASETS = FORECAST_DIR / "future datasets"
FORECAST_FUTURE_SCENARIOS = FORECAST_DIR / "future_scenarios"
FORECAST_SARIMAX = FORECAST_DIR / "sarimax"
FORECAST_SARIMAX_INPUTS = FORECAST_DIR / "sarimax_inputs"
FORECAST_VAR_MACRO = FORECAST_DIR / "var_macro"


# ============================================================
# Outputs (system assets, NOT temporary analysis)
# ============================================================
OUTPUT_DIR = PROJECT_ROOT / "outputs"

FIGURE_DIR = OUTPUT_DIR / "figures"
TABLE_DIR = OUTPUT_DIR / "tables"
MODEL_DIR = OUTPUT_DIR / "models"
SHAP_DIR = OUTPUT_DIR / "shap"

# semantic / narrative assets
SPATIAL_CONTEXT_DIR = OUTPUT_DIR / "spatial_context"


# ============================================================
# Safe directory creation
#   - create outputs and split (generated by code)
#   - do NOT auto-create raw subfolders (avoid hiding bugs)
# ============================================================
for p in [
    OUTPUT_DIR,
    FIGURE_DIR,
    TABLE_DIR,
    MODEL_DIR,
    SHAP_DIR,
    SPATIAL_CONTEXT_DIR,
    DATA_DIR,
    RAW_DIR,
    PROCESSED_DIR,
    FEATURE_DIR,
    PREPROCESSED_DIR,
    FORECAST_DIR,
    SPLIT_DIR,
    TRAIN_DIR,   
    TEST_DIR,
]:
    p.mkdir(parents=True, exist_ok=True)


# ============================================================
# Optional sanity check (call manually if needed)
# ============================================================
def verify_project_layout(strict: bool = False) -> None:
    """
    Verify critical project paths.
    strict=False -> print warnings
    strict=True  -> raise FileNotFoundError
    """
    critical_paths = [
        PROJECT_ROOT / "src",
        DATA_DIR,
        FORECAST_DIR,
        PREPROCESSED_DIR,
        OUTPUT_DIR,
        MODEL_DIR,
    ]

    missing = [p for p in critical_paths if not p.exists()]

    if missing:
        msg = "Missing expected paths:\n" + "\n".join(f"- {p}" for p in missing)
        if strict:
            raise FileNotFoundError(msg)
        else:
            print("[config warning]", msg)







